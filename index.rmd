---
title: "What Explains the Electoral Success of the AfD?"
subtitle: "An Analysis of the March 2016 State Elections in Germany"
author: "Md Mujahedul Islam & Johannes Schulz-Knappe"
date: |
  | May 17, 2016
  | Hertie School of Governance
output: 
  html_document:
    theme: "united"
    fig_caption: yes
    toc: yes
    number_sections: yes
bibliography: Library.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

``` {r initialisation, echo = F, message = F, warning = F}
#options(repos=c(CRAN="http://mirrors.softliste.de/cran/"))

rm(list = ls())

## Load packages for analysis

load <- c("repmis", "magrittr", "scales", "betareg", "dplyr", "xtable", "texreg", 
          "stargazer", "readxl", "ggplot2", "grid", 
          "captioner", "foreign", "rms", "Zelig", 
          "knitr", "GGally", "gridExtra", 
          "zoo", "rugarch", "psych", "plotly", "ggplot2")

loaded <- lapply(load, function(x) {
  if(!require(x, character.only = T)) {
    install.packages(x)
    require(x, character.only = T)
  }
})
rm(load, loaded)

figcap <- captioner(prefix = "Figure", 
                    auto_space = TRUE, levels = 1, type = NULL)
tablecap <- captioner(prefix = "Table", 
                      auto_space = TRUE, levels = 1, type = NULL)


# Set the working directory:

# Create list of commonly used working directories (update, if needed)
possible_dir <- c('C:/Users/Johannes SK/Dropbox/Studium/Spring2016/CollaborativeResearch/Final-Project',
                  'C:/Users/User/Documents/GitHub/Final-Project')

set_valid_wd(possible_dir) # Set to first valid directory in the possible_dir vector
rm(possible_dir) # remove possible_dir vector

```

```{r data, echo=F, warning=F, message=F, error=F}
load("Data.Rda") # Load data file
```

![](March2016_State-elections.jpg)

# Introduction

Within less than three years of being founded by discontented members of the incumbent Christian Democratic Union (CDU), the newly-formed party "Alternative for Germany" (AfD) has already achieved extraordinary vote share in the General election of 2013, the European Parliament election of 2014, [@arzheimer2015afd] and lately in the three state elections in Baden-Württemberg, Rhineland-Palatinate, and Saxony-Anhalt held on March 2016. The rise of a party that stands against European Integration, argues for a re-arrangement of Germany's liberal foreign and economic policies, and vows for taking strong measure against immigrants, has presented a novel scenario into understanding factors that drive electorate to vote for a party that seemingly stands against the 'norm of the land'. Thus this research project endeavors to understand the factors that explain the success and rise of AfD in Germany's political landscape. In the following, we present current literature, the selected datasets, our applied methodology, and our findings. All work is done using the software R [@CiteR].

## The Research Question

On March 13, 2016, Germany's political landscape experienced "a landslide"[@Zeit2016]. At the three state elections in Bade-Württemberg, Rhineland-Palatinate, and Saxony-Anhalt, the AfD received double digit results from scratch, meaning that it has not been present in the state parliaments before. In Baden-Württemberg (BW), the party received 15.1%, in Rhineland-Palatinate (RP) 12.6%, and in Saxony-Anhalt (SA) even 24.3% [@BWStateOffice; @RPStateOffice; @SAStateOffice], becoming the third strongest party in BW and RP, and the second strongest in SA.
Not only does the tremendous success of this new political player harden the setup of the future governments in the respective states, it is also a clear sign that the party has arrived in German mainstream politics [@Spiegel2016].

Our research question is:

*"What explains the recent electoral success of the AfD in the different administrative districts of Baden-Württemberg, Rhineland-Palatinate, and Saxony-Anhalt?"*

We want to understand which structural factors affect the electoral success of the AfD and whether the characteristics of its voters identified in post-election analyses are reflected in the district level data. Also, we want to find out whether it follows the same patterns as the electoral success of radical right populist parties in the rest of Western Europe.

## About the AfD 

Having been founded in February 2013 initially as a eurosceptic party, the AfD just missed the entry into the German national parliament at the federal elections in September 2013 by only 125,000 votes [@schmitt2014euro]. Not a single party in the post-war era was that successful in national elections being only established seven months before [@niedermayer2015neue]. 
This emergence is attributed to the Euro crisis and chancellor Merkels strong state interventionist austerity politics that opened political potential to the right of the established right wing parties CDU/CSU and FDP. The AfD recognized that potential and positioned itself initially as an expert knowledge based eurosceptic party. But over the last years, it became a new host for now unrepresented national conservatives as well as right wing populists. The unifying factors for these different groups are the anti-establishment attitude of the AfD and the image of being the political underdog who is "honest" in face of political and medial lies. In this regard, the AfD shares similarities to other European right wing populist parties [@hausler2015rechten].

![](AfD_logo.png)

The recent refugee crisis that has hit Europe and especially Germany is seen as a major factor that led to new and increased support for the AfD. Chancellor Angela Merkels slogan "Wir schaffen das", expressing optimism with regards to the capability of government and society to handle the refugee crisis, was mostly criticized by members of the AfD and to some extend from the CDU itself. As long as the refugee crisis persists, it is assumed that the AfD is going to continue to gain more support [@Spiegel2016].After the March elections, a large debate arose within the CDU/CSU whether the refugee crisis response by chancellor Merkel was responsible for the loss in votes for the CDU. Interestingly, leaders of other parties who supported Merkels "Wir schaffen das" experienced less loss of votes. However, left parties such as "Die Linke" seemed to be especially vulnerable to the emergence of the AfD [@Spiegel2016]. Also, the social democrats (SPD) seem to have lost many voters to the AfD [@Zeit2016].


# Hypotheses

Based on insights from previous research on the success of RRWP parties in Western Europe and the findings from post-election analysis for the AfD, we aim to test the following hypotheses for the three state elections.

Demographic hypotheses

> *H1a*: The average level of education in a district has a negative impact on the electoral success of the AfD.

> *H1b*: The unemployment rate in a district has a positive impact on the electoral success of the AfD.

Foreign exposure hypothesis

> *H2*: The volume of asylum seekers in a district has a positive impact on the electoral success of the AfD.

Economic hypothesis

> *H3*: Local GDP per capita has a negative impact on the electoral success of the AfD.

Political hypotheses

> *H4a*: The rate of non-voters in previous state elections in a district has a positive impact on the electoral success of the AfD.

> *H4b*: The success of left wing parties in previous state elections in a district has a positive impact on the electoral success of the AfD.


# Data Sources

In order to test these hypotheses, we combined two main data types in order to generate our variables.

The first data type is the electoral data provided by the State Offices for Statistics on the last state elections in Baden-Württemberg [@BWStateOffice], Rhineland-Palatinate [@RPStateOffice], and Saxony-Anhalt [@SAStateOffice]. The variables retrieved from these datasets are:

Variable | Name in dataset | Description |
--------------------|-----------------|-------------------------------|
Dependent Variable (DV) | **vote.AfD** | The vote share of the Alternative for Germany in the current state election |
Independent Variable 1 (IV1) | **lag.turnout** | Overall voter turnout of the previous state election                        |
IV2, IV3, IV4, IV5, IV6 | **lag.CDU**, **lag.Greens**, **lag.SPD**, **lag.FDP**, **lag.Linke** | The vote share of political parties in the previous state election (CDU, SPD, Greens, FDP, and Linke) |

The second data type is on the structural characteristics on the administrative districts. We retrieve this data from the regional data base of the Federal Statistical Office DESTATIS [@DESTATIS]. As this data is available on district level, we chose the districts as our level of analysis. The variables retrieved from these datasets are:

Variable | Name in dataset | Description |
--------------------|-----------------|-------------------------------|
IV7 | **abitur.ratio**| Ratio of school leavers per district with general qualification for university entrance (Abitur) |
IV8 | **nodegree.ratio** | Ratio of school leavers per district with no school degree |
IV9 | **GDP.cap** | Gross domestic product (GDP) per capita (by 1000)| 
IV10 | **unemp.rate** | Unemployment rate in the district |
IV11 | **n.refugees** | Number of asylum seekers per district |
IV12 | **public.debt** | Aggregated debt of the municipalities in a district (by 1000) |
IV13 | **district.type** | Categorical variable, 1 for urban districts, 0 for country districts |


# Empirical Findings

With the generated dataset we were able to conduct our analysis. Since our dependent variable is a [0, 1] bounded variable (meaning, the vote share can take values between 0% and 100%), we used beta regression for our analysis. In the beginning we used OLS to get a basic idea of the relationships of the selected variables.

## Descriptive Statistics
Table 3 shows general descriptive statistics of our variables. Except for the variables "GDP per capita" and "Public Debt" (both divided by 1000) and "number of refugees" (absolute numbers), they are all in percent. 

The standard deviations for "GDP per capita" and "vote share of Linke" are particularly large in comparison to the respective means. GDP per capita differs substantially between rural districts and heavily urbanized ones and while the Linke is very strong in Saxony Anhalt, it is barely present in BW and RP.

```{r sumstat, echo=F, warning=F, message=F, error=F, results='asis'}
summary_labels <- c('Vote share of AfD in 2016', 'Vote turnout in 2011', 
                    'Vote share of CDU in 2011', 'Vote share of Greens in 2011', 
                    'Vote share of SPD in 2011', 'Vote share of FDP in 2011', 
                    'Vote share of Linke in 2011', 'Abitur ratio', 
                    'No degree ratio', 'GDP per capita / 1000', 
                    'Unemployment rate', 'Number of refugees', 'Public debt / 1000')

stargazer(Data[4:17],
          covariate.labels = summary_labels,
          font.size = 'tiny',
          title= 'Summary statistics of the covariates',
          type="html", header = FALSE)
```

## Correlations among variables
Table 4 provides a correlation matrix of a selection of our variables. 

It is important to note that the AfD vote share is negatively correlated with the SPD vote share, but only slightly with the CDU vote share. GDP per capita and high school degree ratio are negatively correlated with AfD vote share, while the unemployment rate and the number of refugees are positively correlated with it.

When it comes to IV/IV correlations, the large positive correlation between GDP per capita and the high school degree ratio is not surprising. However, it is interesting to see that the high school degree ratio is negatively correlated with the previous vote share of the CDU, and positively with the unemployment rate.

```{r corr, echo=F, warning=F, message=F, error=F, results='asis'}
correlation.matrix <- cor(Data[, c("vote.AfD","lag.CDU",
                                   "lag.SPD","GDP.capita",
                                   "unempl.rate",
                                   "abitur.ratio")])
stargazer(correlation.matrix,
          title= 'Correlation matrix of some variables',
          digits = 2,
          type="html", 
          header = FALSE, 
          no.space = FALSE)
```       

## Distribution of AfD Vote Share
When lining up the districts according to the vote share of the AfD, it becomes clear that the party achieved an overall stable and even vote share. The only real outliers are a couple of districts in Saxony Anhalt where the AfD achieved it's by far greatest successes.

```{r bar, echo=F, warning=F, message=F, error=F, results='hide', fig.width=13}
barplot <- ggplot(Data) +
  geom_bar(aes(y = vote.AfD, 
               x = reorder(district.name, -vote.AfD),
               fill = state), 
           stat = "identity") +
  ylab("AfD vote share (in %)") +
  xlab("Districts of Baden-Württemberg, Rhineland-Palatinate, and Saxony Anhalt") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 90))

ggplotly(barplot)
```

## Correlations

In the following, we test our hypotheses with simple correlations.

### Correlation of AfD vote share and abitur ratio (H1a)

... Add text ...

``` {r fig1, echo = F, message = F, results = "hide", error=F, fig.height=4}
fig1 <- ggplot2::ggplot(Data, aes(log(x = abitur.ratio), vote.AfD, colour = state)) + 
  xlab("Abitur ratio per district (log)") +
  ylab("AfD vote share (in %)") +
  geom_point(aes(colour = state)) + 
  geom_smooth() + 
  theme_bw()

ggplotly(fig1)
```

### Correlation of AfD vote share and unemployment rate (H1b)

The following graph shows a statistically significant (the t value from the Pearson's product-moment correlation test is 6.27) positive correlation of the logged unemployment rate in a district with the AfD vote share. However, the correlation seems to be negative for districts with lower unemployment rates but becomes strongly positive for districts with high unemployment. The positive correlation of the abitur ratio with the unemployment rate and its negative correlation with the AfD vote share visible in the correlation matrix could offer a possible explanation for this. We will test this later by controlling for urbanization.

``` {r fig2, echo = F, message = F, results = "hide", error=F, fig.height=4}
fig2 <- ggplot2::ggplot(Data, aes(log(x = unempl.rate), vote.AfD, colour = state)) + 
  xlab("Unemployment rate per district (log)") +
  ylab("AfD vote share (in %)") +
  geom_point(aes(colour = state)) + 
  geom_smooth() + 
  theme_bw()

ggplotly(fig2)
```

### Correlation of AfD vote share and number of refugees (H2)

The result shows a positive correlation of the number of refugees per district with the AfD vote share. But it is not statistically significant since the t value is 0.13 (from the Pearson's product-moment correlation test). Since the data on the refugees per district is from 2013, it is highly outdated. We were not able to acquire more recent data (for 2014 or even for 2015) in order to conduct a meaningful analysis here.

``` {r fig3, echo = F, message = F, results = "hide", error=F, fig.height=4}
fig3 <- ggplot2::ggplot(Data,aes(log(x = n.refugees), vote.AfD, colour = state)) + 
  xlab("Number of refugees per district (log)") +
  ylab("AfD vote share (in %)") +
  geom_point(aes(colour = state)) + 
  geom_smooth() + 
  theme_light()

ggplotly(fig3)
```

### Correlation of AfD vote share and GDP per capita (H3)
The following graph shows a slightly statistically significant (t value is -2.04) negative correlation of GDP per capita with AfD vote share. The effect seems to be mostly influenced by a small group of outliers (high vote share, low GDP per capita) and the variance is not equal across the independent variable (posing a problem with heteroscedasticity).

``` {r fig4, echo = F, message = F, results = "hide", error=F, fig.height=4}
fig4 <- ggplot2::ggplot(Data, aes(log(x = GDP.capita), vote.AfD, colour = state)) + 
  xlab("GDP per capita per district / 1000 (log)") +
  ylab("AfD vote share (in %)") +
  geom_point(aes(colour = state)) + 
  geom_smooth() + 
  theme_bw()

ggplotly(fig4)
```

### Correlation of AfD vote share and voter turnout in previous elections (H4a)

... Add text here ...

``` {r fig5, echo = F, message = F, results = "hide", error=F, fig.height=4}
fig5 <- ggplot2::ggplot(Data, aes(log(x = lag.turnout), vote.AfD, colour = state)) + 
  xlab("Previous voter turnout per district (log)") +
  ylab("AfD vote share (in %)") +
  geom_point(aes(colour = state)) + 
  geom_smooth() + 
  theme_bw()

ggplotly(fig5)
```

### Correlation of AfD vote share and strength of left wing parties (H4b)

... Add text here ...

``` {r fig6, echo = F, message = F, results = "hide", error=F, fig.height=4}
fig6 <- ggplot2::ggplot(Data, aes(log(x = lag.SPD), vote.AfD, colour = state)) + 
  xlab("Previous voteshare of SPD per district (log)") +
  ylab("AfD vote share (in %)") +
  geom_point(aes(colour = state)) + 
  geom_smooth() + 
  theme_bw()
ggplotly(fig6)
```


## Inferential Statistics

Since the initial descriptive statistics and graphs indicate certain relations and interactions, we built several regression models which we ran as OLS regression analysis first and then as beta regression.

### Normal multivariate OLS regression analysis

Testing some initial regression models, we see that the unemployment rate, the vote share of the SPD in previous elections, and the ratio of people leaving school without a formal degree are statistically significant across all models. In almost each model a one percentage point increase of the unemployment rate leads to a one percentage point increase of the AfD vote share.
On the other hand, the number of refugees per district and the vote share of the CDU are insignificant in every model.

``` {r regout, echo = F, message = F, results = "asis", error=F}
reg1 <- lm(vote.AfD ~ GDP.capita + unempl.rate + n.refugees, data = Data)
reg2 <- lm(vote.AfD ~ GDP.capita + unempl.rate + n.refugees + lag.CDU + 
             lag.SPD + lag.turnout, data = Data)
reg3 <- lm(vote.AfD ~ GDP.capita + unempl.rate + n.refugees + 
             abitur.ratio + nodegree.ratio, data = Data)
reg4 <- lm(vote.AfD ~ GDP.capita + unempl.rate + n.refugees 
           + lag.CDU + lag.SPD + lag.turnout + abitur.ratio + 
             nodegree.ratio, data = Data)
reg5 <- lm(vote.AfD ~ GDP.capita + unempl.rate + n.refugees 
           + lag.CDU + lag.SPD + lag.turnout + abitur.ratio + 
             nodegree.ratio + state, data = Data)

var_labels <- c('GDP per capita / 1000', 'Unemployment rate', 'Number of refugees', 
                'Vote share of CDU in 2011 election',
                'Vote share of SPD in 2011 election',
                'Voter turnout in 2011 election',
                'Abitur ratio', 'No degree ratio', 'State')

stargazer::stargazer(reg1, reg2, reg3, reg4, reg5,
                     omit = 'as.factor*', 
                     omit.stat = c('f', 'ser'), # to nicely fits on the page
                     out.header = F,
                     title = 'Determinants of electoral success for the Alternative for Germany',
                     dep.var.labels = 'Vote share of AfD',
                     covariate.labels = var_labels,
                     label = 'AfD_voteshare',
                     add.lines = list(c('District FE', rep('NO', 5))),
                     float = F, df = F, # add float and df to F
                     type="html", header = F, 
                     no.space = T,
                     digits = 2) # add no.space=TRUE to remove space in betwen line. 
```

... Add text on the interaction here, Mujahed ...


```{r AfD.prcnt, echo=F, warning=F, message=F, error=F}

# Create new variable by dividing vote.AfD variable by 100
Data$vote.AfD.prcnt <- Data$vote.AfD/100 

# Reorder variables to replace vote.AfD.prcnt variable in place of vote.AfD
reord <- Data[c(0:3, 19, 5:18, 4)] 
Data <- reord

```

```{r interaction, echo=F, warning=F, message=F, results = "asis", error=F}

#rega1 <- lm(vote.AfD.prcnt ~ state*unempl.rate, data = Data)

Data$state=as.factor(Data$state)
rega1 <- lm(vote.AfD.prcnt ~ GDP.capita + state*unempl.rate + state + unempl.rate + n.refugees 
           + lag.CDU + lag.SPD + lag.turnout + abitur.ratio + 
             nodegree.ratio, data = Data)
summary(rega1)
Data$predicted=predict(rega1)
apatheme=theme_bw()+
  theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        panel.border=element_blank(),
        axis.line=element_line(),
        text=element_text(family='Times'))

p=ggplot(Data, aes(x=unempl.rate, y=vote.AfD.prcnt, shape=state))+
geom_point()+
scale_shape_manual(values=c(1,6,9), name='States', labels=c('Rhineland-Palatinate','Baden-Württemberg', 'Saxony-Anhalt'))+
geom_line(aes(x = unempl.rate, y = predicted, linetype=state)) +
scale_linetype_discrete(name='Districts', labels=c('Rhineland-Palatinate','Baden-Württemberg', 'Saxony-Anhalt'))+
labs(x = 'Unemployment rate', y = 'Vote share of AfD')+
apatheme
p
#ggsave('scatter1.png', width=6, height=6, unit='in', dpi=300)
```

With just a small selection of variables, the models have surprisingly high adjusted R^2. Between 40% and 64% of the variation of AfD vote share could be explained. However, this type of analysis (OLS) is not as suited for the analysis of a [0, 1] bounded dependent variable as the following beta regression.


### Beta regression analysis

... Description of beta regression here ...

``` {r betareganalysis, echo = F, message = F, results = "asis", error=F}
betalogit1 <- betareg(vote.AfD.prcnt ~ GDP.capita + unempl.rate + n.refugees, data = Data)
betalogit2 <- betareg(vote.AfD.prcnt ~ GDP.capita + unempl.rate + n.refugees + lag.CDU + 
             lag.SPD + lag.turnout, data = Data)
betalogit3 <- betareg(vote.AfD.prcnt ~ GDP.capita + unempl.rate + n.refugees + 
             abitur.ratio + nodegree.ratio, data = Data)
betalogit4 <- betareg(vote.AfD.prcnt ~ GDP.capita + unempl.rate + n.refugees 
           + lag.CDU + lag.SPD + lag.turnout + abitur.ratio + 
             nodegree.ratio, data = Data)
betalogit5 <- betareg(vote.AfD.prcnt ~ GDP.capita + unempl.rate + n.refugees 
           + lag.CDU + lag.SPD + lag.turnout + abitur.ratio + 
             nodegree.ratio + state, data = Data)

var_labels <- c('GDP per capita / 1000', 'Unemployment rate', 'Number of refugees', 
                'Vote share of CDU in 2011 election',
                'Vote share of SPD in 2011 election',
                'Voter turnout in 2011 election',
                'Abitur ratio', 'No degree ratio', 'state')

stargazer::stargazer(betalogit1, betalogit2, betalogit3, betalogit4, betalogit5,
                     omit = 'as.factor*', 
                     omit.stat = c('f', 'ser'), # to nicely fits on the page
                     out.header = F,
                     title = 'Beta logit regression showing determinants of electoral success for the Alternative for Germany',
                     dep.var.labels = 'Vote share of AfD',
                     covariate.labels = var_labels,
                     label = 'AfD_voteshare',
                     add.lines = list(c('District FE', rep('NO', 5))),
                     font.size = 'tiny', # make the font tiny
                     float = F, df = F, # add float and df to F
                     type="html", header = F, 
                     no.space = T,
                     digits = 2) # add no.space=TRUE to remove space in betwen line. 
```

... What did you do here? Please shortly explain ...

``` {r betareganalyis, echo = F, message = F, results = "asis", error=F}
betalogit <- betareg(vote.AfD.prcnt ~ unempl.rate, data = Data)
betaloglog <- betareg(vote.AfD.prcnt ~ unempl.rate, data = Data, link = "loglog")

betareg <- ggplot(Data, aes(x = unempl.rate, y = vote.AfD.prcnt)) +
  geom_point(size = 4, shape = 21) +
  scale_fill_grey() +
  geom_line(aes(y = predict(betaloglog, Data),
                colour = "log-log", linetype = "log-log")) +
  geom_line(aes(y = predict(betalogit, Data), 
                colour = "logit", linetype = "logit")) +
  scale_colour_manual("", values = c("red", "blue")) +
  scale_linetype_manual("", values = c("solid", "dashed")) +
  theme_bw()

ggplotly(betareg)
```


## Limitations and Future Research

- Extend analysis on all state elections in Germany where the AfD has participated in order to increase observations

- Access more recent data on refugee numbers
 
- Include additional variables, like "immigration"

- Create interaction models 

- Use beta regression as dependent variable is [0, 1] bounded


## References