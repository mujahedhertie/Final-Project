---
title: "What Explains the Electoral Success of the AfD?"
subtitle: "An Analysis of the March 2016 State Elections in Germany"
author: "Md Mujahedul Islam & Johannes Schulz-Knappe"
date: |
  | May 16, 2016
  | Hertie School of Governance
output:
  pdf_document: default
  fonttheme: structuresmallcapsserif
  html_document: null
  colortheme: beaver
  slide_level: 2
  theme: Warsaw
header-includes: \widowpenalties 1 150

bibliography:
- Library.bib
- Packages1.bib
- Packages2.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

``` {r initialisation, echo = F, message = F, warning = F}
#options(repos=c(CRAN="http://mirrors.softliste.de/cran/"))

rm(list = ls())

load <- c("repmis", "magrittr", "scales", "betareg", "dplyr", "xtable", "texreg", 
          "stargazer", "readxl", "ggplot2", "grid", 
          "captioner", "foreign", "rms", "Zelig", 
          "knitr", "GGally", "gridExtra", 
          "zoo", "rugarch", "psych")

loaded <- lapply(load, function(x) {
  if(!require(x, character.only = T)) {
    install.packages(x)
    require(x, character.only = T)
  }
})
rm(load, loaded)

figcap <- captioner(prefix = "Figure", 
                    auto_space = TRUE, levels = 1, type = NULL)
tablecap <- captioner(prefix = "Table", 
                      auto_space = TRUE, levels = 1, type = NULL)


# Set the working directory:

# Create list of commonly used working directories (update, if needed)
possible_dir <- c('C:/Users/Johannes SK/Dropbox/Studium/Spring2016/CollaborativeResearch/Final-Project',
                  'C:/Users/User/Documents/GitHub/Final-Project')

set_valid_wd(possible_dir) # Set to first valid directory in the possible_dir vector
rm(possible_dir) # remove possible_dir vector
```

```{r data, echo=F, warning=F, message=F, error=F}
load("Data_new.Rda") # Load data file

# Create new variable by dividing vote.AfD variable by 100
Data$vote.AfD.prcnt <- Data$vote.AfD/100 

# Reorder variables to replace vote.AfD.prcnt variable in place of vote.AfD
reord <- Data[c(0:3, 20, 5:19, 4)] 
Data <- reord
```

# Introduction

Within less than three years of being founded by discontented members of the incumbent Christian Democratic Union (CDU), the newly-formed party "Alternative for Germany" (AfD) has already achieved extraordinary vote share in the General election of 2013, the European Parliament election of 2014, [@arzheimer2015afd] and  lately in the three state elections in Baden-Württemberg, Rhineland-Palatinate, and Saxony-Anhalt held on March 2016. The rise of a party that stands against European Integration, argues for a re-arrangement of Germany's liberal foreign and economic policies, and vows for taking strong measure against immigrants, has presented a novel scenario into understanding factors that drive electorate to vote for a party that seemingly stands against the 'norm of the land'. Thus this research proposal endeavors to understand the factors that explain the success and rise of AfD in Germany's political landscape. In the following, we present current literature, and identify the plausible datasets and methodology that this research is going to base on. All work is done using the software R [@CiteR].

## The Research Project

On March 13, 2016, Germany's political landscape experienced "a landslide"[@Zeit2016]. At the three state elections in Bade-Württemberg, Rhineland-Palatinate, and Saxony-Anhalt, the AfD received double digit results from scratch, meaning that it has not been present in the state parliaments before. In Baden-Württemberg (BW), the party received 15.1%, in Rhineland-Palatinate (RP) 12.6%, and in Saxony-Anhalt (SA) even 24.3% [@BWStateOffice; @RPStateOffice; @SAStateOffice], becoming the third strongest party in BW and RP, and the second strongest in SA.
Not only does the tremendous success of this new policital player harden the set up of the future governments in the respective states, it is also a clear sign that the party has arrived in German mainstream politics [@Spiegel2016].

Our main research question is:

*"What explains the recent electoral success of the AfD in the different constituencies of Baden-Württemberg, Rhineland-Palatinate, and Saxony-Anhalt?"*

We want to understand which structural factors affect the eletoral success of the AfD and whether the characteristics of its voters identified in post-election analyses are reflected in the constituency level data. Furthermore, we want to find out whether the AfD success follows the same patterns as the electoral success of radical right populist parties in the rest of Western Europe.

## About the AfD

Having been founded in February 2013 initially as a eurosceptic party, the AfD just missed the entry into the German national parliament at the federal elections in September 2013 by only 125,000 votes [@schmitt2014euro]. Not a single party in the post-war era was that successful in national elections being only established seven months before[@niedermayer2015neue]. 
This emergence is attributed to the Eurocrisis and chancellor Merkels strong state interventionist austerity politcs that opened political potential to the right of the established right wing parties CDU/CSU and FDP. The AfD recognized that potential and positioned itself initially as an expert knowledge based eurosceptic party. But over the last years, it became a new host for now unrepresented national conservatives as well as right wing populists. The unifying factors for these different groups are the anti-establishment attitude of the AfD and the image of being the political underdog who is "honest" in face of political and medial lies. In this regard, the AfD shares similarities to other European right wing populist parties [@hausler2015rechten].

The recent refugee crisis that has hit Europe and especially Germany is seen as a major factor that led to new and increased support for the AfD. Chancellor Angela Merkels slogan "Wir schaffen das", expressing optimism with regards to the capability of government and society to handle the refugee crisis, was mostly critized by members of the AfD and to some extend from the CDU itself. As long as the refugee crisis persists, it is assumed that the AfD is going to continue to gain more support [@Spiegel2016].After the March elections, a large debate arose within the CDU/CSU whether the refugee crisis response by chancellor Merkel was responsible for the loss in votes for the CDU. Interestingly, leaders of other parties who supported Merkels "Wir schaffen das" experienced less loss of votes. However, left parties such as "Die Linke" seemed to be especially vulnerable to the emergence of the AfD [@Spiegel2016]. Also, the social democrats (SPD) seem to have lost many voters to the AfD [@Zeit2016].


# Literature review

Early analysis of the elections has shown that the AfD was especially successful in mobilizing former non-voters [@Spiegel2016]. It was also very successful amongst labourers and unemployed people. In Saxony-Anhalt, almost one third of this group voted for the AfD. But the analysis also showed that more people with medium education and income voted for the AfD. It is suggested that they are increasingly afraid of change, see the refugee crisis as a culmination of external threat, and are skeptical in the governments capacity to solve it [@Zeit2016].

In a mixed-methods study focussing on the AfD's history, self-description, positioning in the public discourse, and its supporters, @Berbuir2015 found that the party can be described as a "functional equivalent for a right-wing populist party in a country where right-wing politics are strongly stigmatised" [@Berbuir2015]. For our research this means that the AfD can be located in the tradtion of new radical right wing populist (RRWP) parties in Western Europe.

When it comes to the understanding of the rise of RRWP parties, @Ivarsflaten2008 and @swank2003globalization offer important insights.
In her large scale study comparing the electoral success of RRWP parties, @Ivarsflaten2008 found that successful RRWP parties almost always used anti-immigration rhethorics in their electoral campaigns. The other two focus areas of RRWP parties - opposing political elitism and complains about the economic development - were not always instrumentalized by successful RRWP parties and seem to be more context specific.
@swank2003globalization analyzed the impact of globalization on the electoral success of RRWP parties in national elections in 16 Western European nations between 1981 and 1998. Their core finding was that the generousity of the welfare state was an important factor that mitigated the impact of economic globalizations on the rise of RRWP parties. Besides that, they found that the volume of refugees and asylum seekers, the level of international immigration, the height of domestic tax burden, previous electoral success of left libertarian parties, and the past voteshare of the RRWP parties all systematically and positively influenced their electoral success. In some occasions, previously declining strength of established right-wing parties was another factor that explained RRWP party success. Interestingly, slow economic growth and the rate of people employed in manufacturing jobs did not have a significant impacts [@swank2003globalization, 230].

# Hypotheses

Based on the insights from previous research on the success of RRWP parties in Western Europe and the findings from post-election analysis for the AfD, we aim to test the following hypotheses for the three state elections.

Demographic hypotheses

> *H1a*: The average level of education in a constituency has a negative impact on the electoral success of the AfD.

> *H1b*: The unemployment rate in a constituency has a positive impact on the electoral success of the AfD.

Foreign exposure hypothesis

> *H2*: The volume of refugees and asylum seekers in a constituency has a positive impact on the electoral success of the AfD.

Economic hypothesis

> *H3*: The height of local tax rates has a positive impact on the electoral success of the AfD.

Political hypotheses

> *H4a*: The rate of non-voters in previous state elections in a constituency has a positive impact on the electoral success of the AfD.

> *H4b*: Declining voteshare of established right wing parties in previous state elections in a constituency has a positive impact on the electoral success of the AfD.

The last hypothesis is based on the assumption that it is the left-shift of extablished right parties that opens up potential for the AfD. A left-shift of a conservative party often ocurrs when it faces political pressure which should be visible in a relative decline in vote share when comparing the previous two state elections.

---

# Introduction

As proposed in the research proposal of Assignment02, we want to understand the factors that explain the success and rise of AfD in Germany's political landscape. At the three state elections in Bade-Württemberg, Rhineland-Palatinate, and Saxony-Anhalt, the AfD received double digit results from scratch, meaning that it has not been present in the state parliaments before. In Baden-Württemberg (BW), the party received 15.1%, in Rhineland-Palatinate (RP) 12.6%, and in Saxony-Anhalt (SA) even 24.3%, becoming the third strongest party in BW and RP, and the second strongest in SA.

While our initial attempt was to gather data on constituency level, we had to adapt to available data sources. This is why we changed the level of analysis to the administrative districts of the three German states.

Thus, the updated research question is:

*"What explains the recent electoral success of the AfD in the different administrative districts of Baden-Württemberg, Rhineland-Palatinate, and Saxony-Anhalt?"*

We want to understand which structural factors affect the electoral success of the AfD and whether the characteristics of its voters identified in post-election analyses are reflected in the district level data. Also, we want to find out whether it follows the same patterns as the electoral success of radical right populist parties in the rest of Western Europe

In the following, we present our data collection efforts and initial analysis that was undertaken with the generated dataset.



## Introduction

- Within less than three years of being founded, the **Alternative for Germany** (AfD) has achieved extraordinary vote share in the General election of 2013 and the European Parliament election of 2014 [@arzheimer2015afd]

- March 2016: **15.1%** in Baden-Württemberg, **12.6%** in Rhineland-Palatinate, **24.3%** in Saxony-Anhalt

- "**a landslide**"[@Zeit2016]

- The AfD has **"arrived in German mainstream politics"** [@Spiegel2016]



## Existing Research

- AfD can be described as a "**functional equivalent for a right-wing populist party** in a country where right-wing politics are strongly stigmatised" [@Berbuir2015]

- Successful right-wing populist parties almost always use **anti-immigration rhethorics** [@Ivarsflaten2008]

- **Volume of refugees**, level of **immigration**, domestic **tax burden**, and strong presence of **left-wing parties** positively influences right wing-populist electoral success [@swank2003globalization]

- AfD was especially successful in mobilizing former **non-voters** and the **unemployed** [@Spiegel2016]


## Research Question

*"What explains the recent electoral success of the AfD in the different districts of Baden-Württemberg, Rhineland-Palatinate, and Saxony-Anhalt?"*

- What structural factors correlate with the success?

- Are those the same characteristics found for other western European countries?


# Data sources and methodology

We access the electoral data via the State Offices for Statistics in Baden-Württemberg [@BWStateOffice], Rhineland-Palatinate [@RPStateOffice], and Saxony-Anhalt [@SAStateOffice]. We will use the datasets on the March 2016 and the previous two elections in order to retrieve the secondary vote share of the AfD as our dependent variable, and the previous vote shares of right wing parties for hypothesis H4b. The rate of previous non-voters is also retreived from these datasets.
The Federal Returning Officer [@Bwldata] offers data on constituency level containing information on the unemployment rate, the level of education, and business tax (which we will use as a proxy for local taxation).
The Federal Statistical Office DESTATIS [@DESTATIS] provides data on the number of refugees in the constituencies. This data is available on county level, which is why we will disaggregate the data according to the population size in each constituency.

After merging the data, we will first analyse descriptive statistics in the form of maps, graphs, and distributions in order to provide a basic overview of the trends in the data. Since our dependent variable is vote share of AfD, we will perform OLS estimations and run different linear models. Besides, we expect to run interaction models in order to test our aforementioned hypotheses.




# Data and Variables
```{r echo=F, warning=F, message=F, error=F}
# Load data file
load("Data.Rda")
```

As stated in the Assignment 2 research proposal, we combine two main data types in order to get our variables.

The first data type is the electoral data provided by the State Offices for Statistics on the last state elections in  Baden-Württemberg, Rhineland-Palatinate, and Saxony-Anhalt. The variables retrieved from these datasets are:

Variable | Name in dataset | Description |
--------------------|-----------------|-------------------------------|
Dependent Variable (DV) | **vote.AfD** | The vote share of the Alternative for Germany in the current state election |
Independent Variable 1 (IV1) | **lag.turnout** | Overall voter turnout of the previous state election                        |
IV2, IV3, IV4, IV5, IV6 | **lag.CDU**, **lag.Greens**, **lag.SPD**, **lag.FDP**, **lag.Linke** | The vote share of political parties in the previous state election (CDU, SPD, Greens, FDP, and Linke) |

The second data type is on the structural characteristics on the administrative districts. We retrieve this data from the Federal Statistical Office DESTATIS. As this data is only available on district level, we adapted our data collection on it. The variables retrieved from these datasets are:

Variable | Name in dataset | Description |
--------------------|-----------------|-------------------------------|
IV7 | **abitur.ratio**| Ratio of school leavers per district with general qualification for university entrance (Abitur) |
IV8 | **nodegree.ratio** | Ratio of school leavers per district with no school degree |
IV9 | **GDP.cap** | Gross domestic product (GDP) per capita | 
IV10 | **unemp.rate** | Unemployment rate in the district |
IV11 | **n.refugees** | Number of asylum seekers per district |


## Data Gathering

**Election Data**

Gathering the election data was complicated due to the independence of the Statistical State Offices. Every German state office chooses its own format to provide data online. While we thought about collecting data on all state elections in Germany where the AfD has won seats, we had to limit our efforts to the three states Baden-Württemberg (BW), Rhineland-Palatinate (RP), and Saxony Anhalt (SA) in order to provide a working dataset in the given time frame. However, for the final analysis, we will try to extend our dataset to achieve a greater sample.

We retrieved district level data on the 2016 and 2011 state elections from the respective websites. While the data was available in separate files for RP and SA, district level data was only available for BW in a combined table that had to be divided in following steps. In total, we gathered five different datasets on the elections.

**Structural Data**

The website of the DESTATIS online database "Genesis-Online" was the source of the structural data files. As DESTATIS does not offer an API, the data had to be manually downloaded from the database. We saved four datasets as csv files that were subsequently loaded into our project. While this is only initial data, the similar structure of DESTATIS data allows us to include further datasets on new variables in case we see the need for that during analysis.

## Data Cleaning and Merging
The biggest challenge during the data cleaning was the generation of a common identifier for the different dataset. Except for the SA data, the election datasets is not provided with the district key which is the main identifier for the DESTATIS data. In order to add the identifier to the election data, we converted the district names that were available in both the election and the structural DESTATIS data into the same format and structure. Then, we sorted the data frames in the same way to add the identifier to the election data.

Finally, we merged all datasets into a single one which contains the variables mentioned above, the election year, and a state indicator on 94 observations.



## Election Data

*Source: State Statistical Offices of @BWStateOffice, @RPStateOffice, and @SAStateOffice*

Variable | Name in dataset | Description |
--------------------|-----------------|-------------------------------|
Dependent Variable (DV) | **vote.AfD.prcnt** | The vote share of the Alternative for Germany in the current state election |
Independent Variable 1 (IV1) | **lag.turnout** | Overall voter turnout of the previous state election                        |
IV2, IV3, IV4, IV5, IV6 | **lag.CDU**, **lag.Greens**, **lag.SPD**, **lag.FDP**, **lag.Linke** | The vote share of political parties in the previous state election (CDU, SPD, Greens, FDP, and Linke) |

## Structural Data

*Source: Federal Statistical Office [@DESTATIS]*

Variable | Name in dataset | Description |
--------------------|-----------------|-------------------------------|
IV7 | **abitur.ratio**| Ratio of school leavers per district with general qualification for university entrance (Abitur) |
IV8 | **nodegree.ratio** | Ratio of school leavers per district with no school degree |
IV9 | **GDP.capita** | Gross domestic product (GDP) per capita / 1000 | 
IV10 | **unemp.rate** | Unemployment rate in the district |
IV11 | **n.refugees** | Number of asylum seekers per district |

# Empirical Findings
With the generated dataset we were able to conduct initial analysis of correlations and distributions. While our dependent variable is a [0, 1] bounded variable (meaning, the vote share can take values between 0% and 100%), we will use beta regression for our final analysis. For the beginning, we use OLS to get a basic idea of the relationships of the selected variables.

## Descriptive Statistics
Table 3 shows general descriptive statistics of our variables. Except for the "GDP per capita" and "number of refugees" variables they are all in percent. 

The standard deviations for "GDP per capita" and "vote share of Linke" are particularly large in comparison to the respective means. GDP per capita differs substantially between rural districts and heavily urbanized ones and while the Linke is very strong in Saxony Anhalt, it is barely present in BW and RP.

```{r sumstat, echo=F, warning=F, message=F, error=F, results='asis'}
summary_labels <- c('Vote share of AfD in 2016', 'Vote turnout in 2011', 
                    'Vote share of CDU in 2011', 'Vote share of Greens in 2011', 
                    'Vote share of SPD in 2011', 'Vote share of FDP in 2011', 
                    'Vote share of Linke in 2011', 'High school ratio', 
                    'No degree ratio', 'GDP per capita / 1000', 
                    'Unemployment rate', 'Number of refugees')

stargazer(Data[4:16],
          covariate.labels = summary_labels,
          font.size = 'tiny',
          title= 'Summary statistics of the covariates',
          type="latex", header = FALSE)
```

## Correlations Among Variables
Table 4 provides a correlation matrix of a selection of our variables. 

It is important to note that the AfD vote share is negatively correlated with the SPD vote share, but only slightly with the CDU vote share. GDP per capita and high school degree ratio are negatively correlated with AfD vote share, while the unemployment rate and the number of refugees are positively correlated with it.

When it comes to IV/IV correlations, the large positive correlation between GDP per capita and the high school degree ratio is not surprising. However, it is interesting to see that the high school degree ratio is negatively correlated with the previous vote share of the CDU, and positively with the unemployment rate.

```{r corr, echo=F, warning=F, message=F, error=F, results='asis'}
correlation.matrix <- cor(Data[, c("vote.AfD","lag.CDU",
                                   "lag.SPD","GDP.capita",
                                   "unempl.rate",
                                   "abitur.ratio")])
stargazer(correlation.matrix,
          title= 'Correlation matrix of some variables',
          font.size = 'tiny',
          digits = 2,
          type="latex", 
          header = FALSE, 
          no.space = FALSE)
```       

## Distribution of AfD Vote Share
When lining up the districts according to the vote share of the AfD, it becomes clear that the party achieved an overall stable and even vote share. The only real outliers are a couple of districts in Saxony Anhalt where the AfD achieved its by far greatest successes.


```{r bar, echo=F, warning=F, message=F, error=F, results='hide', fig.width=13}
ggplot(Data) +
  geom_bar(aes(y = vote.AfD, 
               x = reorder(district.name, -vote.AfD),
               fill = state), 
           stat = "identity") +
  ylab("AfD vote share (in %)") +
  xlab("Districts of Baden-Württemberg, Rhineland-Palatinate, and Saxony Anhalt") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 90))
```


### Correlation of AfD vote share and GDP per capita
The following graph shows a slightly statistically significant (t value is -2.04) negative correlation of GDP per capita with AfD vote share. The effect seems to be mostly influenced by a small group of outliers (high vote share, low GDP per capita) and the variance is not equal across the independent variable (posing a problem with heteroscedasticity).

``` {r fig1, echo = F, message = F, results = "hide", error=F, fig.height=4}
ggplot2::ggplot(Data, aes(log(x = GDP.capita), vote.AfD)) + 
  xlab("GDP per capita per district / 1000 (log)") +
  ylab("AfD vote share (in %)") +
  geom_point(aes(colour = state)) + 
  geom_smooth() + 
  theme_bw()
```

### Correlation of AfD vote share and unemployment rate

The following graph shows a statistically significant (the t value from the Pearson's product-moment correlation test is 6.27) positive correlation of the logged unemployment rate in a district with the AfD vote share. However, the correlation seems to be negative for districts with lower unemployment rates but becomes strongly positive for districts with high unemployment. The positive correlation of the high school degree ratio with the unemployment rate and its negative correlation with the AfD vote share visible in the correlation matrix could offer a possible explanation for this. We will test this in future analysis with interaction variables.

``` {r fig2, echo = F, message = F, results = "hide", error=F, fig.height=4}
ggplot2::ggplot(Data, aes(log(x = unempl.rate), vote.AfD, colour = state)) + 
  xlab("Unemployment rate per district (log)") +
  ylab("AfD vote share (in %)") +
  geom_point(aes(colour = state)) + 
  geom_smooth() + 
  theme_bw()
```

### Correlation of AfD vote share and number of refugees

The result shows a positive correlation of the number of refugees per district with the AfD vote share. But it is not statistically significant since the t value is 0.13 (from the Pearson's product-moment correlation test). Since the data on the refugees per district is from 2013, it is highly outdated. We will have to get more recent data (for 2014 or even for 2015) to be able to conduct a meaningful analysis here.


``` {r fig3, echo = F, message = F, results = "hide", error=F, fig.height=4}
ggplot2::ggplot(Data,aes(log(x = n.refugees), vote.AfD)) + 
  xlab("Number of refugees per district (log)") +
  ylab("AfD vote share (in %)") +
  geom_point(aes(colour = state)) + 
  geom_smooth() + 
  theme_light()
```

## Inferential Statistics: normal multivariate OLS regression analysis

Testing some initial regression models, we see that the unemployment rate, the vote share of the SPD in previous elections, and the ratio of people leaving school without a formal degree are statistically significant across all models. In almost each model a one percentage point increase of the unemployment rate leads to a one percentage point increase of the AfD vote share.
On the other hand, the number of refugees per district and the vote share of the CDU are insignificant in every model.

With just a small initial selection of variables, the models have surprisingly high adjusted R^2. Between 40% and 64% of the variation of AfD vote share could be explained. However, since our current type of analysis (OLS) is not as suited for the analysis of a [0, 1] bounded dependent variable as for example beta regression, these findings are likely to change in our final analysis.


``` {r regout, echo = F, message = F, results = "asis", error=F}
reg1 <- lm(vote.AfD ~ GDP.capita + unempl.rate + n.refugees, data = Data)
reg2 <- lm(vote.AfD ~ GDP.capita + unempl.rate + n.refugees + lag.CDU + 
             lag.SPD + lag.turnout, data = Data)
reg3 <- lm(vote.AfD ~ GDP.capita + unempl.rate + n.refugees + 
             abitur.ratio + nodegree.ratio, data = Data)
reg4 <- lm(vote.AfD ~ GDP.capita + unempl.rate + n.refugees 
           + lag.CDU + lag.SPD + lag.turnout + abitur.ratio + 
             nodegree.ratio, data = Data)
reg5 <- lm(vote.AfD ~ GDP.capita + unempl.rate + n.refugees 
           + lag.CDU + lag.SPD + lag.turnout + abitur.ratio + 
             nodegree.ratio + state, data = Data)

var_labels <- c('GDP per capita / 1000', 'Unemployment rate', 'Number of refugees', 
                'Vote share of CDU in 2011 election',
                'Vote share of SPD in 2011 election',
                'Voter turnout in 2011 election',
                'Abitur ratio', 'No degree ratio', 'state')

stargazer::stargazer(reg1, reg2, reg3, reg4, reg5,
                     omit = 'as.factor*', 
                     omit.stat = c('f', 'ser'), # to nicely fits on the page
                     out.header = F,
                     title = 'Determinants of electoral success for the Alternative for Germany',
                     dep.var.labels = 'Vote share of AfD',
                     covariate.labels = var_labels,
                     label = 'AfD_voteshare',
                     add.lines = list(c('District FE', rep('NO', 5))),
                     font.size = 'tiny', # make the font tiny
                     float = F, df = F, # add float and df to F
                     type="latex", header = F, 
                     no.space = T,
                     digits = 2) # add no.space=TRUE to remove space in betwen line. 
```


```{r interaction, echo=F, warning=F, message=F, error=F}

#rega1 <- lm(vote.AfD.prcnt ~ state*unempl.rate, data = Data)

Data$state=as.factor(Data$state)
rega1 <- lm(vote.AfD.prcnt ~ GDP.capita + state*unempl.rate + state + unempl.rate + n.refugees 
           + lag.CDU + lag.SPD + lag.turnout + abitur.ratio + 
             nodegree.ratio, data = Data)
summary(rega1)
Data$predicted=predict(rega1)
apatheme=theme_bw()+
  theme(panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),
        panel.border=element_blank(),
        axis.line=element_line(),
        text=element_text(family='Times'))

p=ggplot(Data, aes(x=unempl.rate, y=vote.AfD.prcnt, shape=state))+
geom_point()+
scale_shape_manual(values=c(1,6,9), name='Districts', labels=c('Rhineland-Palatinate','Baden-Württemberg', 'Saxony-Anhalt'))+
geom_line(aes(x = unempl.rate, y = predicted, linetype=state)) +
scale_linetype_discrete(name='Districts', labels=c('Rhineland-Palatinate','Baden-Württemberg', 'Saxony-Anhalt'))+
labs(x = 'Unemployment rate', y = 'Vote share of AfD')+
apatheme
p
#ggsave('scatter1.png', width=6, height=6, unit='in', dpi=300)
```


```

## Inferential Statistics: Beta regression analysis

``` {r betareganalysis, echo = F, message = F, results = "asis", error=F}
betalogit1 <- betareg(vote.AfD.prcnt ~ GDP.capita + unempl.rate + n.refugees, data = Data)
betalogit2 <- betareg(vote.AfD.prcnt ~ GDP.capita + unempl.rate + n.refugees + lag.CDU + 
             lag.SPD + lag.turnout, data = Data)
betalogit3 <- betareg(vote.AfD.prcnt ~ GDP.capita + unempl.rate + n.refugees + 
             abitur.ratio + nodegree.ratio, data = Data)
betalogit4 <- betareg(vote.AfD.prcnt ~ GDP.capita + unempl.rate + n.refugees 
           + lag.CDU + lag.SPD + lag.turnout + abitur.ratio + 
             nodegree.ratio, data = Data)
betalogit5 <- betareg(vote.AfD.prcnt ~ GDP.capita + unempl.rate + n.refugees 
           + lag.CDU + lag.SPD + lag.turnout + abitur.ratio + 
             nodegree.ratio + state, data = Data)

var_labels <- c('GDP per capita / 1000', 'Unemployment rate', 'Number of refugees', 
                'Vote share of CDU in 2011 election',
                'Vote share of SPD in 2011 election',
                'Voter turnout in 2011 election',
                'Abitur ratio', 'No degree ratio', 'state')

stargazer::stargazer(betalogit1, betalogit2, betalogit3, betalogit4, betalogit5,
                     omit = 'as.factor*', 
                     omit.stat = c('f', 'ser'), # to nicely fits on the page
                     out.header = F,
                     title = 'Beta logit regression showing determinants of electoral success for the Alternative for Germany',
                     dep.var.labels = 'Vote share of AfD',
                     covariate.labels = var_labels,
                     label = 'AfD_voteshare',
                     add.lines = list(c('District FE', rep('NO', 5))),
                     font.size = 'tiny', # make the font tiny
                     float = F, df = F, # add float and df to F
                     type="latex", header = F, 
                     no.space = T,
                     digits = 2) # add no.space=TRUE to remove space in betwen line. 
```


``` {r betareganalyis, echo = F, message = F, results = "asis", error=F}
betalogit <- betareg(vote.AfD.prcnt ~ unempl.rate, data = Data)
betaloglog <- betareg(vote.AfD.prcnt ~ unempl.rate, data = Data, link = "loglog")


library(ggplot2)
ggplot(Data, aes(x = unempl.rate, y = vote.AfD.prcnt)) +
  geom_point(size = 4, shape = 21) +
  scale_fill_grey() +
  geom_line(aes(y = predict(betaloglog, Data),
                colour = "log-log", linetype = "log-log")) +
  geom_line(aes(y = predict(betalogit, Data), 
                colour = "logit", linetype = "logit")) +
  scale_colour_manual("", values = c("red", "blue")) +
  scale_linetype_manual("", values = c("solid", "dashed")) +
  theme_bw()
```


View("Data")

## Limitations and Future Research

- Extend analysis on all state elections in Germany where the AfD has participated in order to increase observations

- Access more recent data on refugee numbers
 
- Include additional variables, like "immigration"

- Create interaction models 

- Use beta regression as dependent variable is [0, 1] bounded

## Q&A

**Thank you for your attention!**

## References {.allowframebreaks}